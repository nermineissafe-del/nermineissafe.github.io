<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>My Unconscious~Conscious Knowledge Archive</title>
<style>
/* ===== BASE STYLES ===== */
body { font-family:'Courier New', monospace; background:#ffc0cb; color:#1a1a1a; margin:0; padding:40px; max-width:1000px; line-height:1.7; position:relative; overflow-x:hidden; perspective:1400px; }
h1{text-align:center;font-size:3em;color:#660033;margin-bottom:20px;border-bottom:3px solid #660033;padding-bottom:10px;}
h2{color:#330011;border-left:6px solid #660033;padding-left:15px;margin-top:60px;}
p{margin-top:15px;white-space:pre-line;}
hr{margin:50px 0;border-top:2px dashed #660033;}
.writable{background:#f5e6c8;border:2px solid #8b6f47;padding:25px;margin-top:25px;min-height:140px;font-family:'Courier New', monospace;box-shadow:0 10px 25px rgba(0,0,0,0.35);background-image:radial-gradient(rgba(0,0,0,0.05) 1px, transparent 1px);background-size:4px 4px;}
.writable:focus{outline:none;box-shadow:0 0 30px rgba(139,111,71,0.6);}
#feelingsTable{width:100%;border-collapse:collapse;margin-top:15px;}
#feelingsTable th,#feelingsTable td{border:1px solid #8b6f47;padding:6px;text-align:left;}
input, button{font-family:'Courier New', monospace;}
</style>
</head>
<body>

<h1>My Creepy Knowledge Archive</h1>

<h2>Diary</h2>
<div class="writable" contenteditable="true" id="diaryBox"></div>

<h2>Love / Gentle Things</h2>
<div class="writable" contenteditable="true" id="loveBox"></div>

<h2>Grounding Notes</h2>
<div class="writable" contenteditable="true" id="survivalBox"></div>

<hr>

<h2>Bear Asks: How are you feeling?</h2>
<input type="text" id="bearInput" placeholder="Write your feeling here...">
<button id="saveBear">Save</button>
<table id="feelingsTable">
<thead><tr><th>Year</th><th>Time</th><th>Feeling</th></tr></thead>
<tbody id="feelingsBody"></tbody>
</table>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, doc, setDoc, onSnapshot, collection, addDoc, query, orderBy, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

// ====== FIREBASE CONFIG ======
const firebaseConfig = {
  apiKey: "YOUR_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT",
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// ====== PERSISTENT TEXTBOXES ======
const boxes = {
  diaryBox: doc(db, "pages", "diary"),
  loveBox: doc(db, "pages", "love"),
  survivalBox: doc(db, "pages", "survival")
};

Object.keys(boxes).forEach(id => {
  const el = document.getElementById(id);

  // Load existing content
  onSnapshot(boxes[id], snap => {
    if (snap.exists() && el.innerText !== snap.data().text) {
      el.innerText = snap.data().text;
    }
  });

  // Save every change
  el.addEventListener("input", () => {
    setDoc(boxes[id], { text: el.innerText });
  });
});

// ====== BEAR FEELINGS ======
const bearInput = document.getElementById('bearInput');
const saveBear = document.getElementById('saveBear');
const feelingsBody = document.getElementById('feelingsBody');

async function loadBearFeelings() {
  feelingsBody.innerHTML = "";
  const q = query(collection(db, "bearFeelings"), orderBy("timestamp", "asc"));
  const querySnapshot = await getDocs(q);
  querySnapshot.forEach(docSnap => {
    const { text, time, year } = docSnap.data();
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${year}</td><td>${time}</td><td>${text}</td>`;
    feelingsBody.appendChild(tr);
  });
}

saveBear.onclick = async () => {
  const text = bearInput.value.trim();
  if(!text) return;
  const now = new Date();
  const time = now.toTimeString().split(" ")[0];
  const year = now.getFullYear();

  await addDoc(collection(db, "bearFeelings"), { text, time, year, timestamp: now });
  bearInput.value = "";
  loadBearFeelings();
};

// Load bear feelings on start
loadBearFeelings();
</script>

</body>
</html>














